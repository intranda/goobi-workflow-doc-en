# 2.12. Edit task details

On the page shown here, the details and plugins for tasks can be configured. The page does not differ significantly between tasks of process templates and those of existing processes. Differences are marked where appropriate.

![On this page, fundamental settings and plugins can be configured for tasks.](../../.gitbook/assets/placeholder.png)

## Title

The title of the task is specified in this field. This can be freely selected. However, it should be taken into account that Goobi scripts, for example, use the respective task titles to automatically execute background tasks across many processes.

Therefore titles should be short, meaningful and unique. Spaces and special characters are allowed.

## Order

The position number is used to specify the position of a task in a process template or an existing process. Accordingly, an integer must be specified here.

On the one hand, the position number is used to display all tasks of a process in the correct processing sequence. On the other hand, when tasks are completed, those next tasks within a process that follow the sequence according to the current task are unlocked.

Several tasks can have the same position number. This then means for Goobi that the concerning tasks may be executed simultaneously. Parallel processing works with both automatic and manual tasks (for example, when several employees are working on a task in parallel).

If the task sequence of a process is configured with gaps (for example 1, 2, 3, 6), Goobi jumps directly to the task with the next highest number.

The order of tasks also plays an important role in Goobi Scripts. There, based on the number specified here, further administrative precautions can be taken.

## Allow parallel tasks

**This setting is only available when creating a new task within a process template.**

Furthermore, this setting is only relevant when new tasks are to be inserted between already existing tasks.

If this option is **set**, the position number is set directly when the task is created. It may happen that another task already exists with the same number and both tasks can be processed in parallel later.

If this option is **not set**, then in the case of a duplication of the sequence number with that of another already existing task, the sequence numbers of the other and all subsequent tasks are shifted back by exactly one number when saving. This ensures that the new task inserted in the process does not duplicate any existing position number and that the subsequent tasks can still retain their defined numbering relative to each other (including missing and duplicated numbers).

If it turns out afterwards that this option was wrongly selected when creating the task and all subsequent tasks have a "wrong" position number, there are two possible solutions: For small adjustments, the position number can be adjusted at any time in the task overview of the process template using the buttons available for this purpose. For large adjustments, or if tasks already exist for the current process template, it is recommended to write a Goobi script so that it adjusts all "wrong" numbers and is executed on all incorrectly numbered tasks.

## Priority

In this list it is possible to select a priority for the current task. It should be noted that the priorities `Standard`, `Priority`, `High priority` and `Highest priority` are only intended to visually represent the importance of tasks. They have no further technical effect on the corresponding process.

The `Correction` option also has no effect on the task, but is automatically set if the final result in a task to be completed is not to be accepted and a correction message is sent.

## Metadata

This option can be activated if it is in the sense of the task to edit metadata.

If a task is marked with the 'Metadata' property, additional icons and options are displayed at various places in the user interface to access metadata. For example, the button for calling the metadata editor is also displayed if a task has this property.

If metadata in a task is to be uploaded, downloaded, validated or used in any other way, this option must be selected.

## Read images

This option can be enabled if the user in this task should get read access to image files in his user folder (on the Goobi server). This may be the case, for example, when images are to be downloaded or displayed for quality checking.

## Write images

This option can be activated if the user in this task should get write access to image files in his user folder (on the Goobi server). This is required whenever images are to be uploaded or edited.

## Validate on exit

This option can be enabled to validate the metadata of the process when completing this task. This validation has nothing to do with the validation plugin (see below). The type of validation set here checks if all metadata, structure elements (DocStructs) and page counts have been applied according to the rule set.

## Export

This option can be enabled if it is in the sense of the task to export data for further processing with other systems. This can be, for example, other database formats, content management systems (CMS) or simply certain file formats. If this task is defined as an export task, an export plugin must be selected in the 'Step plugin' field. Export plugins usually start with the prefix `intranda_export_`.

If this task is an automatic task and an export task at the same time, the export will take place automatically. Regardless of this, the user will see an export button next to the corresponding task in the overview and can also export the dataset manually.

## Skip this task

This option can be selected if the task should be skipped in the process. If a task has this property, it will be closed automatically as soon as a user accepts it. If this task is an automatic task, it will also be skipped and closed automatically.

## Automatic task

Different types of tasks can be configured as automatic tasks. This allows, for example, plugins or Goobi scripts to be executed either directly or in one of the available processing queues.

Specifically, the following types of tasks can be automated: Internal tasks (`intranda_step_*`), export tasks (`intranda_export_*`), script tasks, HTTP tasks and time delay tasks (`intranda_delay_*`). In each case, make sure that the appropriate plugin or script is selected as described in the corresponding chapter.

In order to use processing queues, they must first be enabled and set up in the corresponding configuration files (`goobi_config.properties` and `goobi_activemq.xml`). If this option is then activated, a drop-down menu appears below the checkbox from which the desired processing queue can be selected.

If the option `Don't execute in processing queue` is selected, the corresponding plugin or script will be executed directly as soon as the task is reached in the process. This option is recommended only for tasks that should be triggered by the user in real time, for example by completing the previous task.

The `Processing queue for fast jobs` and `Processing queue for slow jobs` options provide two independently operating processing queues that are normally the right choice for most automated tasks. The fast processing queue is intended for tasks that have a rather short execution time and should be completed promptly.

The slow processing queue, on the other hand, should be used for tasks that require a lot of processing time and for which it is not really relevant how quickly they are completed. For example, the slow processing queue can be used for large amounts of image exports, OCR analysis, 3D calculations, or other complex applications. As a result, this processing queue is also suitable for tasks that sometimes require a total computing time of hours, days or even longer over many thousands of processes.

However, by default, Goobi always prioritizes tasks that are being executed by users in real time and tasks that are in the fast processing queue. For example, if Goobi is busy during the day due to the work of many active employees and there is also a well-filled slow processing queue, it is therefore common for this to make its greatest progress at night.

In addition, there is an `In queue for external processing` option. This processing queue can be used by REST API requests. Suitable REST API requests are usually provided by plugins.

## Generate thumbnails

## Script step

This option can be enabled to run one or more scripts on the server as part of the current process. For example, these can be Bash or Python scripts that perform background tasks or interact directly with the current task's dataset in the file system.

**The numeric return values of the scripts play an important role in workflow control. Therefore, they are documented in detail following this chapter and should be strictly observed.**

If the script step option is activated, a table appears below the checkbox in which up to five script files can be entered. For each script a name and a path can be entered, whereby the path is the absolute path (including script file name) in the server file system. The associated name can be freely selected and serves exclusively the simpler recognition for the user.

Any fields in the table can be filled in or left blank. If this task is executed later in a process, Goobi will execute all filled script path fields from top to bottom.

Care must be taken to ensure that the specified scripts are executable. Otherwise, error messages in the journal and server log files will indicate the cause of non-execution. Common causes of errors are for example missing execution rights, wrong environment variables (especially `PATH`), missing interpreters, wrong file paths or missing parameters. Parameters can easily be specified in the script field.

If another script language is to be used, an interpreter must be specified if necessary. In this case, the interpreter is the executed program and then executes the script file specified as a parameter.

The script lines read from the table (but not the script files themselves) will be searched again by the variable replacer in Goobi Workflow when executing the scripts in a process and any variables will be replaced. This can be used to insert metadata values into certain fields. For example, parameters for the scripts specified here can be written so that the parameter values correspond to the variables for the variable replacer.

A few examples of scripts:

```
/opt/digiverso/goobi/scripts/copyfiles.sh
bash /opt/digiverso/goobi/scripts/myExampleScript.sh --action convert
python /opt/digiverso/goobi/scripts/doAnything.py
/etc/python /opt/digiverso/goobi/scripts/convertImages.py --type *.jpg *.png
```

If the available script fields are not sufficient, a kind of meta script file can be written instead, which in turn executes several scripts and occupies only one field in the table.

**Return values of script files**

The respective return value of a script is used by Goobi Workflow to determine the current status of the corresponding task, especially between the processing of multiple scripts within one task. A distinction is made between `Success`, `Error`, `Reopen task` and `Continue task`.

The return value, for example 99, is specified in Bash scripts with the command `return 99` or in python with `sys.exit(99)` to the end of the script. This should properly handle any errors caught by `if` blocks or other situations, and in particular should not use `return` statements without return values.

The following table gives an overview of the respective behavior of Goobi:

| Return value | Status | Action of Goobi |
| ------------ | ------ | --------------- |
| `0` | Completed | Executes the next script of this task |
| `1` and all undefined values | Error | Cancels execution of this task |
| `98` | Open | Cancels execution and restarts the task |
| `99` | In process | Executes the next script of this task |

If a script outputs text in the error output stream (STDERR), this is also treated as an error condition (`1`). Errors are documented in the journal and server log files.

The input and output streams STDIN and STDOUT are currently not used.

**Combination of multiple scripts**

The value **0** can be used if a script is the only or last script in a task. If the script was successfully executed, the task is set to `Completed` status. If `0` is used and scripts follow afterwards, unwanted side effects may occur.

The value **1** (and all undefined values) can be used if a script fails. Goobi will then not execute any further scripts and set the current task directly to `Error` status. Error messages (STDERR output and goobi-internal errors) are logged in the journal and server log.

The value **98** can be used if a script could not be executed as desired and Goobi should be told to restart the whole task. Accordingly, the execution of the first defined script will be started again if it is an automatic task. The status of the task is set back to `Open` by the return value `98` and to `In process` in case of an automatic task. This return value can be used, for example, for situations when scripts perform error handling in their own error detection and then need to be re-executed to benefit from their own error corrections on the next execution attempt. Validation scripts can also be used at this point to detect errors from previous scripts and cause the task to restart accordingly.

The value **99** can be used if a script could be executed successfully and another script is to be executed afterwards. The status of the task is not yet set to `Completed` with `99` (in contrast to `0`), which makes sense if several scripts follow each other. The last script should then return `0` to complete the task.

If the provided script fields are not sufficient and multiple script calls are outsourced to an external script file, make sure that all return values are passed correctly and arrive back in Goobi to achieve the desired effects in task automation.

## HTTP step

## Status

In this drop-down menu, the status of the task can be set manually. Typically, in a process template, all tasks are set to `Locked` and the first one to `Open`, so that later in each process, editing can start at the first task. In the course of editing, Goobi sets all open tasks to `In queue` or `In process` and finished tasks to `Completed`. In case of an error, the task is automatically set to `Error`.

Additionally, there is an option `Deactivated` to deactivate a task completely. This will be skipped by Goobi when editing the process. The `Error` status can also be used manually to indicate that an edit has not taken place as desired and may need to be repeated.

When setting the status in a task in an already existing and edited process, care should be taken here to avoid unwanted side effects caused by automatic tasks being opened or closed manually, which are triggered by this intervention in the workflow.

## Batch step

This option can be enabled if the current task should be able to be grouped and executed together with similar tasks within a batch.

## Step plugin

In this drop-down menu, a plugin is selected that is to be used for the task currently being processed. There are different possibilities for what the plugin selected here can be used for. Different possibilities are described in more detail in other subchapters on this page.

Plugins can be used for automatic or semi-automatic tasks. In this case, time delay plugins (`intranda_delay_*`), validation plugins (`intranda_validation_*`), export plugins (`intranda_export_*`) or other types of plugins can be selected. Plugins that bring their own user interface and are not already described in one of the other categories on this page can also be selected here.

For tasks that should not use a plugin, this field is left empty.

## Validation plugin

A task can be configured to run a validation plugin upon completion. The corresponding plugin can be set in this field. Validation plugins usually start with the prefix `intranda_validation_`.

## Plugin for time delay

Time delay plugins can be included as tasks in the process to pause automatic processing for a certain time. If a task is to be used for time delay, this checkbox must be set and a corresponding plugin must be set.

The corresponding plugin is selected in the 'Step plugin' field. Plugins that can be used for time delay usually start with the prefix `intranda_delay_`.

## Update metadata index when finishing

This option can be enabled if metadata has been modified by completing this task and the search index should be updated for the entire dataset of this process.

## Download the docket as PDF file

This option can be enabled to offer generating and downloading a docket PDF file for the current intermediate status of the corresponding process in the task overview. This can be handy to manually check the current technical status of the process.
